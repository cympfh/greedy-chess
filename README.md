# greedy-chess

## Overview

シンプルな貪欲法によるチェスAI.
途中までの棋譜を標準入力に与えると, 次の一手を標準出力に出力する.

## Algorithm

- **Alpha-Beta剪定**による効率的な探索
- **反復深化（Iterative Deepening）**を使用
    - 指定された時間内で可能な限り深く探索
    - タイムアウトはコマンドライン引数で指定（デフォルト5秒）
    - 典型的にはdepth 4-6程度まで到達
- **並列探索**対応
    - マルチスレッドでの高速化（-n オプション）
    - CPUコア数に応じて探索速度が向上
- 評価関数は駒の価値の和
    - 駒の価値は以下の通り
        - ポーン: 1
        - ナイト: 3
        - ビショップ: 3
        - ルーク: 5
        - クイーン: 9
        - キング: 999
- **キャッシュシステム**による結果の再利用
- **オープニングブック**による序盤の最適化

## Usage

### CLI モード (cargo run)

標準入力から棋譜を受け取り、次の一手を標準出力に出力します。

```bash
$ cargo run <<EOF
e4 e5 Nf3 Nc6 Bb5 a6 Ba4 Nf6 O-O Be7
EOF

Re1
```

#### オプション

- `-t <seconds>` または `--timeout <seconds>`: 探索の制限時間を秒単位で指定 (デフォルト: 5)
- `-n <threads>` または `--threads <threads>`: 並列探索に使用するスレッド数 (デフォルト: 直列実行)
- `-p` または `--print-only`: 次の一手を出力せず、現在の盤面のみを表示

例:
```bash
# 10秒のタイムアウトで次の一手を計算
$ echo "e4 e5 Nf3 Nc6" | cargo run -- -t 10

# 4スレッドで並列探索
$ echo "e4 e5 Nf3 Nc6" | cargo run -- -t 5 -n 4

# 8スレッドで10秒間探索
$ echo "e4 e5 Nf3 Nc6" | cargo run -- -t 10 -n 8

# 盤面のみを表示
$ echo "e4 e5 Nf3 Nc6" | cargo run -- -p
```

### Visualizer モード (streamlit run main.py)

ブラウザ上でチェス盤を表示し、対話的に駒を動かしたり、AI推奨手を確認できます。

```bash
$ streamlit run main.py
```

#### 機能

- **対話的な駒の移動**: チェス盤上のマスをクリックして駒を選択・移動
- **AI推奨手の表示**: 現在の局面から次の最善手をAIが提案
- **探索時間の調整**: スライダーで探索時間を変更可能（1-30秒）
- **並列探索スレッド数の調整**: スライダーでスレッド数を変更可能（1-16スレッド）
- **棋譜の表示**: 移動履歴を確認
- **URL共有**: 棋譜がURLパラメータに保存され、共有可能
